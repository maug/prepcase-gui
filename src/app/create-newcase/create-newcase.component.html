<mat-card>
  <mat-card-header>
    <mat-card-title>Create new case</mat-card-title>
    <mat-card-subtitle>Set parameters for CIME script <code>create_newcase</code></mat-card-subtitle>
  </mat-card-header>
  <mat-card-content>

    <form [formGroup]="mainForm" (ngSubmit)="onSubmit()">

      <mat-form-field style="width: 100%">
        <input matInput
               type="text"
               placeholder="Select compset"
               formControlName="compset"
               required
               [matAutocomplete]="autoCompsets"
        >
        <mat-error *ngIf="mainForm.get('compset').hasError('compsetInvalid') && !mainForm.get('compset').hasError('required')">
          Compset name is invalid
        </mat-error>
        <mat-error *ngIf="mainForm.get('compset').hasError('required')">
          Compset is <strong>required</strong>
        </mat-error>

        <mat-autocomplete class="high-autocomplete-panel" #autoCompsets="matAutocomplete">
          <mat-optgroup *ngFor="let group of compsetsGroupsOptions | async" [label]="group.type">
            <mat-option class="small" *ngFor="let compset of group.items" [value]="compset.name">
              <div class="mat-small"><div class="compset-short-name">{{compset.name}}</div> {{compset.longName}}</div>
            </mat-option>
          </mat-optgroup>
        </mat-autocomplete>
      </mat-form-field>

      <button mat-flat-button color="primary" type="submit" [disabled]="!mainForm.valid">Create new case</button>

    </form>

  </mat-card-content>
</mat-card>
